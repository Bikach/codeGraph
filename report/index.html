<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Analysis Benchmark Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>
  <style>
    :root {
      --optimized: #22c55e;
      --baseline: #ef4444;
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #1e293b;
      --text-muted: #64748b;
      --border: #e2e8f0;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 2rem;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 2rem;
    }

    header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 0.5rem;
    }

    header p {
      color: var(--text-muted);
      font-size: 1rem;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border);
    }

    .card h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text);
    }

    .card h3 {
      font-size: 1.1rem;
      font-weight: 600;
      margin: 1rem 0 0.5rem;
      color: var(--text);
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
    }

    .metric-card {
      background: linear-gradient(135deg, var(--optimized) 0%, #16a34a 100%);
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
      color: white;
    }

    .metric-card.baseline {
      background: linear-gradient(135deg, var(--baseline) 0%, #dc2626 100%);
    }

    .metric-card.neutral {
      background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    }

    .metric-value {
      font-size: 2rem;
      font-weight: 700;
      line-height: 1.2;
    }

    .metric-label {
      font-size: 0.875rem;
      opacity: 0.9;
      margin-top: 0.25rem;
    }

    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
      gap: 1.5rem;
    }

    .chart-container {
      position: relative;
      height: 350px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
    }

    th, td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }

    th {
      background: var(--bg);
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      font-size: 0.75rem;
      letter-spacing: 0.05em;
    }

    tr:hover td {
      background: var(--bg);
    }

    .savings-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-weight: 600;
      font-size: 0.75rem;
      background: #dcfce7;
      color: #166534;
    }

    .savings-badge.negative {
      background: #fee2e2;
      color: #991b1b;
    }

    .legend {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: var(--card);
      border-radius: 8px;
      border: 1px solid var(--border);
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1rem;
      font-weight: 500;
    }

    .legend-dot {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }

    .legend-dot.optimized { background: var(--optimized); }
    .legend-dot.baseline { background: var(--baseline); }

    .config-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      font-size: 0.875rem;
    }

    .config-item {
      display: flex;
      flex-direction: column;
    }

    .config-item label {
      color: var(--text-muted);
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .config-item span {
      font-weight: 500;
    }

    @media (max-width: 768px) {
      body { padding: 1rem; }
      header h1 { font-size: 1.75rem; }
      .charts-grid { grid-template-columns: 1fr; }
      .chart-container { height: 300px; }
      table { font-size: 0.75rem; }
      th, td { padding: 0.5rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Code Analysis Benchmark Report</h1>
      <p>MCP vs Native Comparison - Generated: 2025-12-19T09:45:47.308Z</p>
    </header>

    <div class="card">
      <h2>Summary</h2>
      <div class="summary-grid">
        <div class="metric-card">
          <div class="metric-value">45%</div>
          <div class="metric-label">Fewer LLM Calls</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">46%</div>
          <div class="metric-label">Fewer Tokens</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">41%</div>
          <div class="metric-label">Cost Reduction</div>
        </div>
        <div class="metric-card">
          <div class="metric-value">51%</div>
          <div class="metric-label">Faster</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Total Cost Comparison</h2>
      <div class="summary-grid">
        <div class="metric-card">
          <div class="metric-value">$0.5464</div>
          <div class="metric-label">MCP Total Cost</div>
        </div>
        <div class="metric-card baseline">
          <div class="metric-value">$0.9244</div>
          <div class="metric-label">Native Total Cost</div>
        </div>
      </div>
    </div>

    <div class="legend">
      <div class="legend-item">
        <span class="legend-dot optimized"></span>
        <span>MCP</span>
      </div>
      <div class="legend-item">
        <span class="legend-dot baseline"></span>
        <span>Native</span>
      </div>
    </div>

    <div class="charts-grid">
      <div class="card">
        <h2>LLM Calls per Scenario</h2>
        <div class="chart-container">
          <canvas id="llmCallsChart"></canvas>
        </div>
      </div>

      <div class="card">
        <h2>Tokens per Scenario</h2>
        <div class="chart-container">
          <canvas id="tokensChart"></canvas>
        </div>
      </div>

      <div class="card">
        <h2>Cost per Scenario ($)</h2>
        <div class="chart-container">
          <canvas id="costChart"></canvas>
        </div>
      </div>

      <div class="card">
        <h2>Execution Time (seconds)</h2>
        <div class="chart-container">
          <canvas id="timeChart"></canvas>
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Detailed Results</h2>
      <div style="overflow-x: auto;">
        <table>
          <thead>
            <tr>
              <th>Scenario</th>
              <th>MCP Calls</th>
              <th>Native Calls</th>
              <th>MCP Tokens</th>
              <th>Native Tokens</th>
              <th>MCP Cost</th>
              <th>Native Cost</th>
              <th>Cost Savings</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td><strong>Find Callers</strong><br><small style="color: var(--text-muted)">Find all functions that call a specific function</small></td>
              <td>5.0</td>
              <td>7.0</td>
              <td>1 183</td>
              <td>1 276</td>
              <td>$0.0662</td>
              <td>$0.0726</td>
              <td><span class="savings-badge">+9%</span></td>
            </tr>
            
            <tr>
              <td><strong>Find Implementations</strong><br><small style="color: var(--text-muted)">Find all classes that implement a specific interface</small></td>
              <td>3.0</td>
              <td>9.7</td>
              <td>402</td>
              <td>1 509</td>
              <td>$0.0434</td>
              <td>$0.0695</td>
              <td><span class="savings-badge">+38%</span></td>
            </tr>
            
            <tr>
              <td><strong>Impact Analysis</strong><br><small style="color: var(--text-muted)">Analyze the impact of modifying a class or function</small></td>
              <td>12.3</td>
              <td>23.3</td>
              <td>2 606</td>
              <td>5 408</td>
              <td>$0.1873</td>
              <td>$0.3373</td>
              <td><span class="savings-badge">+44%</span></td>
            </tr>
            
            <tr>
              <td><strong>Dependency Analysis</strong><br><small style="color: var(--text-muted)">Analyze all dependencies of a class (incoming and outgoing)</small></td>
              <td>9.7</td>
              <td>28.7</td>
              <td>2 095</td>
              <td>4 244</td>
              <td>$0.1139</td>
              <td>$0.1929</td>
              <td><span class="savings-badge">+41%</span></td>
            </tr>
            
            <tr>
              <td><strong>Call Chain</strong><br><small style="color: var(--text-muted)">Trace the call chain between two functions</small></td>
              <td>11.7</td>
              <td>7.7</td>
              <td>1 737</td>
              <td>2 534</td>
              <td>$0.1355</td>
              <td>$0.2521</td>
              <td><span class="savings-badge">+46%</span></td>
            </tr>
            
          </tbody>
        </table>
      </div>
    </div>

    <div class="card">
      <h2>Configuration</h2>
      <div class="config-info">
        <div class="config-item">
          <label>Project Path</label>
          <span>/Users/bikach/workspace/h-backend</span>
        </div>
        <div class="config-item">
          <label>MCP Runs</label>
          <span>3</span>
        </div>
        <div class="config-item">
          <label>Native Runs</label>
          <span>3</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    Chart.register(ChartDataLabels);

    const scenarios = [{"scenarioName":"Find Callers","description":"Find all functions that call a specific function","optimized":{"llmCalls":5,"toolCalls":4,"tokens":1183.3333333333333,"totalCost":0.06617733333333332,"executionTimeMs":26264},"baseline":{"llmCalls":7,"toolCalls":6,"tokens":1276,"totalCost":0.07257941666666666,"executionTimeMs":27350.666666666668},"savings":{"tokens":7.26227795193313,"cost":8.820797448312371,"time":3.973090235460444,"llmCalls":28.57142857142857}},{"scenarioName":"Find Implementations","description":"Find all classes that implement a specific interface","optimized":{"llmCalls":3,"toolCalls":2,"tokens":401.6666666666667,"totalCost":0.04341553333333333,"executionTimeMs":16342.333333333334},"baseline":{"llmCalls":9.666666666666666,"toolCalls":8.666666666666666,"tokens":1509,"totalCost":0.06948703333333332,"executionTimeMs":26149},"savings":{"tokens":73.38193063839186,"cost":37.51994976520798,"time":37.503027521766285,"llmCalls":68.9655172413793}},{"scenarioName":"Impact Analysis","description":"Analyze the impact of modifying a class or function","optimized":{"llmCalls":12.333333333333334,"toolCalls":11.333333333333334,"tokens":2606.3333333333335,"totalCost":0.1872867,"executionTimeMs":58488.666666666664},"baseline":{"llmCalls":23.333333333333332,"toolCalls":45.666666666666664,"tokens":5408.333333333333,"totalCost":0.3373135,"executionTimeMs":149337},"savings":{"tokens":51.80893682588598,"cost":44.4769628253835,"time":60.83444379713892,"llmCalls":47.14285714285714}},{"scenarioName":"Dependency Analysis","description":"Analyze all dependencies of a class (incoming and outgoing)","optimized":{"llmCalls":9.666666666666666,"toolCalls":8.666666666666666,"tokens":2095.3333333333335,"totalCost":0.11394303333333333,"executionTimeMs":46650.666666666664},"baseline":{"llmCalls":28.666666666666668,"toolCalls":27.666666666666668,"tokens":4244.333333333333,"totalCost":0.19291915,"executionTimeMs":81840.66666666667},"savings":{"tokens":50.63221550302364,"cost":40.93741687472015,"time":42.99818346217448,"llmCalls":66.27906976744185}},{"scenarioName":"Call Chain","description":"Trace the call chain between two functions","optimized":{"llmCalls":11.666666666666666,"toolCalls":10.666666666666666,"tokens":1736.6666666666667,"totalCost":0.13553071666666666,"executionTimeMs":44379.333333333336},"baseline":{"llmCalls":7.666666666666667,"toolCalls":66.33333333333333,"tokens":2534,"totalCost":0.2521239166666667,"executionTimeMs":105026.33333333333},"savings":{"tokens":31.465403841094446,"cost":46.244402967191746,"time":57.74456564861511,"llmCalls":-52.17391304347825}}];

    const chartOptions = {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        datalabels: {
          anchor: 'end',
          align: 'top',
          color: '#1e293b',
          font: { weight: 'bold', size: 11 },
          formatter: (value) => value.toLocaleString()
        }
      },
      scales: {
        y: {
          beginAtZero: true,
          grid: { color: '#e2e8f0' }
        },
        x: {
          grid: { display: false }
        }
      }
    };

    // LLM Calls Chart
    new Chart(document.getElementById('llmCallsChart'), {
      type: 'bar',
      data: {
        labels: scenarios.map(s => s.scenarioName),
        datasets: [
          {
            label: 'MCP',
            data: scenarios.map(s => s.optimized.llmCalls),
            backgroundColor: '#22c55e',
            borderRadius: 6,
            barPercentage: 0.4
          },
          {
            label: 'Native',
            data: scenarios.map(s => s.baseline.llmCalls),
            backgroundColor: '#ef4444',
            borderRadius: 6,
            barPercentage: 0.4
          }
        ]
      },
      options: chartOptions
    });

    // Tokens Chart
    new Chart(document.getElementById('tokensChart'), {
      type: 'bar',
      data: {
        labels: scenarios.map(s => s.scenarioName),
        datasets: [
          {
            label: 'MCP',
            data: scenarios.map(s => s.optimized.tokens),
            backgroundColor: '#22c55e',
            borderRadius: 6,
            barPercentage: 0.4
          },
          {
            label: 'Native',
            data: scenarios.map(s => s.baseline.tokens),
            backgroundColor: '#ef4444',
            borderRadius: 6,
            barPercentage: 0.4
          }
        ]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          datalabels: {
            ...chartOptions.plugins.datalabels,
            formatter: (value) => (value / 1000).toFixed(0) + 'k'
          }
        }
      }
    });

    // Cost Chart
    new Chart(document.getElementById('costChart'), {
      type: 'bar',
      data: {
        labels: scenarios.map(s => s.scenarioName),
        datasets: [
          {
            label: 'MCP',
            data: scenarios.map(s => s.optimized.totalCost),
            backgroundColor: '#22c55e',
            borderRadius: 6,
            barPercentage: 0.4
          },
          {
            label: 'Native',
            data: scenarios.map(s => s.baseline.totalCost),
            backgroundColor: '#ef4444',
            borderRadius: 6,
            barPercentage: 0.4
          }
        ]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          datalabels: {
            ...chartOptions.plugins.datalabels,
            formatter: (value) => '$' + value.toFixed(2)
          }
        }
      }
    });

    // Time Chart
    new Chart(document.getElementById('timeChart'), {
      type: 'bar',
      data: {
        labels: scenarios.map(s => s.scenarioName),
        datasets: [
          {
            label: 'MCP',
            data: scenarios.map(s => s.optimized.executionTimeMs / 1000),
            backgroundColor: '#22c55e',
            borderRadius: 6,
            barPercentage: 0.4
          },
          {
            label: 'Native',
            data: scenarios.map(s => s.baseline.executionTimeMs / 1000),
            backgroundColor: '#ef4444',
            borderRadius: 6,
            barPercentage: 0.4
          }
        ]
      },
      options: {
        ...chartOptions,
        plugins: {
          ...chartOptions.plugins,
          datalabels: {
            ...chartOptions.plugins.datalabels,
            formatter: (value) => value.toFixed(0) + 's'
          }
        }
      }
    });
  </script>
</body>
</html>